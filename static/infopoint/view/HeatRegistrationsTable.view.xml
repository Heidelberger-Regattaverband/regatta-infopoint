<mvc:View controllerName="de.regatta_hd.infopoint.controller.HeatRegistrationsTable" xmlns="sap.m" xmlns:f="sap.f" xmlns:layout="sap.ui.layout" xmlns:mvc="sap.ui.core.mvc">
  <mvc:content>

    <f:DynamicPage toggleHeaderOnTitleClick="false" class="sapUiNoContentPadding">
      <!-- DynamicPage Title -->
      <f:title>
        <f:DynamicPageTitle>
          <f:heading>
            <VBox>
              <Title text="{path: 'heat>/race', formatter: '.formatter.raceLabel'}, {path: 'heat>/', formatter: '.formatter.heatLabel'}" wrapping="true" wrappingType="Normal" />
            </VBox>
          </f:heading>

          <f:navigationActions>
            <!-- <Button type="Transparent" icon="sap-icon://navigation-left-arrow" press="handlePrevious" tooltip="Previous" />
          <Button type="Transparent" icon="sap-icon://navigation-right-arrow" press="handleNext" tooltip="Next" /> -->
            <Button type="Transparent" icon="sap-icon://decline" press="handleClose" tooltip="Close middle column" />
          </f:navigationActions>
        </f:DynamicPageTitle>
      </f:title>

      <!-- DynamicPage Header -->
      <f:header>
        <f:DynamicPageHeader>
          <layout:HorizontalLayout allowWrapping="true">
            <layout:VerticalLayout class="sapUiMediumMarginEnd">
              <ObjectAttribute title="{i18n>common.heatNr}" text="{heat>/number}" />
              <ObjectAttribute title="{i18n>common.date}" text="{path: 'heat>/date', formatter: '.formatter.dateLabel'}" />
              <ObjectAttribute title="{i18n>common.time}" text="{path: 'heat>/time', formatter: '.formatter.timeLabel'}" />
            </layout:VerticalLayout>

            <layout:VerticalLayout>
              <ObjectAttribute title="{i18n>common.distance}" text="{path: 'heat>/race', formatter: '.formatter.distanceLabel'}" />
              <ObjectAttribute title="{i18n>common.state}" text="{path: 'heat>/', formatter: '.formatter.stateLabel'}" />
              <ObjectAttribute title="{i18n>common.refereeAbr}" text="{heat>/referee/lastName}, {heat>/referee/firstName}" visible="{= ${heat>/referee/firstName} !== '' || ${heat>/referee/lastName} !== ''}" />
            </layout:VerticalLayout>
          </layout:HorizontalLayout>
        </f:DynamicPageHeader>
      </f:header>

      <!-- DynamicPage Content -->
      <f:content>
        <Table autoPopinMode="true" items="{path: 'heatRegistration>/', sorter: [{path: 'result/rankSort', descending: false}, {path: 'bib', descending: false} ]}" growing="true" growingThreshold="50" growingScrollToLoad="true" sticky="HeaderToolbar,InfoToolbar,ColumnHeaders" class="sapUiNoContentPadding">

          <columns>
            <Column hAlign="Center" width="3rem" importance="High" popinDisplay="Inline" visible="{= ${heat>/state} >= 4 }">
              <header>
                <Text text="{i18n>common.rank}" class="bold" wrapping="false" />
              </header>
            </Column>
            <Column hAlign="Center" width="3rem" importance="High" popinDisplay="Inline">
              <header>
                <Text text="{i18n>heatRegistrationTable.column.bib}" class="bold" wrapping="false" />
              </header>
            </Column>
            <Column hAlign="Begin" width="12rem" importance="High" popinDisplay="Inline">
              <header>
                <Text text="{i18n>heatRegistrationTable.column.boat}" class="bold" wrapping="false" />
              </header>
            </Column>
            <Column hAlign="Center" width="3rem" importance="Low" popinDisplay="Inline">
              <header>
                <Text text="{i18n>heatRegistrationTable.column.lane}" class="bold" wrapping="false" />
              </header>
            </Column>
            <Column hAlign="End" width="4rem" importance="High" popinDisplay="Inline" visible="{= ${heat>/state} >= 4 }">
              <header>
                <Text text="{i18n>heatRegistrationTable.column.result}" class="bold" wrapping="false" />
              </header>
            </Column>
            <Column hAlign="End" width="4rem" importance="Low" popinDisplay="Inline" visible="{= ${heat>/state} >= 4 }">
              <header>
                <Text text="{i18n>heatRegistrationTable.column.delta}" class="bold" wrapping="false" />
              </header>
            </Column>
            <Column hAlign="Center" width="4rem" importance="Low" popinDisplay="Inline" visible="{= ${heat>/state} >= 4 }">
              <header>
                <Text text="{i18n>common.points}" class="bold" wrapping="false" />
              </header>
            </Column>
          </columns>

          <items>
            <ColumnListItem>
              <cells>
                <Text text="{heatRegistration>result/rankLabel}" />
                <Text text="{heatRegistration>registration/bib}" />
                <Text text="{
                  parts: [
                    {path: 'heatRegistration>registration/shortLabel'},
                    {path: 'heatRegistration>registration/boatNumber'},
                    {path: 'heatRegistration>registration/comment'}
                  ],
                  formatter: '.formatter.boatLabel'
                }" />
                <Text text="{heatRegistration>lane}" />
                <Text text="{heatRegistration>result/result}" />
                <Text text="{= ${heatRegistration>result/delta} !== '0.0' ? ${heatRegistration>result/delta} : '-' }" />
                <Text text="{heatRegistration>result/points}" />
              </cells>
            </ColumnListItem>
          </items>
        </Table>
      </f:content>
    </f:DynamicPage>

  </mvc:content>
</mvc:View>