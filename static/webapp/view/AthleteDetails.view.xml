<mvc:View controllerName="de.regatta_hd.infoportal.controller.AthleteDetails" xmlns="sap.m" xmlns:f="sap.f" xmlns:mvc="sap.ui.core.mvc">
  <mvc:content>

    <!-- see: https://sapui5.hana.ondemand.com/#/entity/sap.ui.core.ContainerPadding and
    https://sapui5.hana.ondemand.com/#/topic/c71f6df62dae47ca8284310a6f5fc80a -->
    <f:DynamicPage toggleHeaderOnTitleClick="false" class="sapUiNoContentPadding">
      <f:title>
        <f:DynamicPageTitle>
          <f:heading>
            <Title text="{athlete>/lastName}, {athlete>/firstName}" wrapping="true" />
          </f:heading>
          <f:actions>
          </f:actions>
          <f:navigationActions>
            <Button tooltip="{i18n>common.refresh}" text="{=!${device>/system/phone}?${i18n>common.refresh}:''}" icon="sap-icon://refresh"
              press=".onRefreshButtonPress" type="Transparent" />
            <Button tooltip="" icon="sap-icon://decline" press=".onNavBack" type="Transparent" />
          </f:navigationActions>
        </f:DynamicPageTitle>
      </f:title>

      <f:header>
        <f:DynamicPageHeader>
          <ObjectAttribute title="{i18n>common.club}"
            text="{=!${device>/system/phone}?${athlete>/club/longName}:${athlete>/club/shortName}}" />
          <ObjectAttribute title="{i18n>common.gender}" text="{=${athlete>/gender}==='M'?${i18n>common.male}:${i18n>common.female}}" />
        </f:DynamicPageHeader>
      </f:header>

      <f:content>
        <Table id="athleteRegistrationsTable" autoPopinMode="true" items="{path:'registrations>/'}" growing="true" growingThreshold="50"
          growingScrollToLoad="true" sticky="ColumnHeaders" class="sapUiNoContentPadding" mode="SingleSelectMaster"
          itemPress=".onSelectionChange">
          <columns>
            <Column hAlign="Begin" width="6rem" importance="High" popinDisplay="Inline">
              <header>
                <Text text="{i18n>common.race}" class="bold" />
              </header>
            </Column>
            <Column hAlign="Begin" width="14rem" importance="High" popinDisplay="Inline">
              <header>
                <Text text="{i18n>common.bib} / {i18n>common.boat}" class="bold" />
              </header>
            </Column>
            <Column hAlign="Begin" width="8rem" importance="Low" popinDisplay="Inline" visible="{=!${device>/system/phone}}">
              <header>
                <Text text="{i18n>common.clubRegistration}" class="bold" />
              </header>
            </Column>
          </columns>

          <items>
            <ColumnListItem type="Navigation"
              highlight="{parts:[{path:'registrations>race'},{path:'registrations>'}],formatter:'.formatter.raceRegistrationHighlight'}">
              <cells>
                <VBox>
                  <Text text="{path:'registrations>race',formatter:'.formatter.nrRaceLabel'}"
                    visible="{=${registrations>cancelled} || ${registrations>race/cancelled}}" class="cancelled sapUiTinyMarginBottom" />
                  <Text text="{path:'registrations>race',formatter:'.formatter.nrRaceLabel'}"
                    visible="{=!${registrations>cancelled} &amp;&amp; !${registrations>race/cancelled}}" class="sapUiTinyMarginBottom" />

                  <Text text="{registrations>race/longLabel}" class="cancelled"
                    visible="{=(${registrations>cancelled} || ${registrations>race/cancelled}) &amp;&amp; !${device>/system/phone}}" />
                  <Text text="{registrations>race/longLabel}"
                    visible="{=!${registrations>cancelled} &amp;&amp; !${registrations>race/cancelled} &amp;&amp; !${device>/system/phone}}" />
                </VBox>

                <HBox alignItems="Center">
                  <Text text="{path:'registrations>',formatter:'.formatter.bibBoatLabel'}" class="cancelled sapUiTinyMarginBottom"
                    visible="{=${registrations>cancelled} || ${registrations>race/cancelled}}" />
                  <Text text="{path:'registrations>',formatter:'.formatter.bibBoatLabel'}" class="sapUiTinyMarginBottom"
                    visible="{=!${registrations>cancelled} &amp;&amp; !${registrations>race/cancelled}}" />
                </HBox>

                <HBox alignItems="Center">
                  <Image src="{registrations>club/flagUrl}" width="25px" class="sapUiTinyMarginEnd" />
                  <Text text="{registrations>club/shortName}" visible="{=${registrations>cancelled} || ${registrations>race/cancelled}}"
                    class="cancelled" />
                  <Text text="{registrations>club/shortName}"
                    visible="{=!${registrations>cancelled} &amp;&amp; !${registrations>race/cancelled}}" />
                </HBox>
              </cells>
            </ColumnListItem>
          </items>
        </Table>

      </f:content>
    </f:DynamicPage>

  </mvc:content>
</mvc:View>